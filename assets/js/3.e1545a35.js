(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{202:function(t,a,s){t.exports=s.p+"assets/img/overview.db493601.png"},203:function(t,a,s){t.exports=s.p+"assets/img/record-list.af3de962.jpg"},204:function(t,a,s){t.exports=s.p+"assets/img/bp-edit.e0803ecc.png"},205:function(t,a,s){t.exports=s.p+"assets/img/mocky-proxy.61834ef5.png"},206:function(t,a,s){t.exports=s.p+"assets/img/moky-simple-demo.f78b09eb.png"},207:function(t,a,s){t.exports=s.p+"assets/img/new-snippet.2b584c7a.png"},208:function(t,a,s){t.exports=s.p+"assets/img/selected-forward.cc4d762d.png"},209:function(t,a,s){t.exports=s.p+"assets/img/mt-eruda.fc57859e.png"},210:function(t,a,s){t.exports=s.p+"assets/img/mt-erra.584c29d1.png"},211:function(t,a,s){t.exports=s.p+"assets/img/include-snippet-autocomplete.ada86b4d.png"},221:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"使用指南"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用指南"}},[t._v("#")]),t._v(" 使用指南")]),t._v(" "),n("h2",{attrs:{id:"概览"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#概览"}},[t._v("#")]),t._v(" 概览")]),t._v(" "),n("blockquote",[n("p",[t._v("Erra由一个http(s)代理服务加UI界面组成，用户通过界面控制代理服务器的行为来实现各种功能。"),n("br"),t._v("\n详情请参阅"),n("router-link",{attrs:{to:"/design.html"}},[t._v("设计文档")])],1)]),t._v(" "),n("h3",{attrs:{id:"ui界面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ui界面"}},[t._v("#")]),t._v(" UI界面")]),t._v(" "),n("p",[n("img",{attrs:{src:s(202),alt:"UI概览"}}),t._v("\nErra界面由三个Tab页组成：")]),t._v(" "),n("ol",[n("li",[t._v("Network：记录所有经过代理服务器的Http请求。")]),t._v(" "),n("li",[t._v("Snippet：编写、管理Snippet。")]),t._v(" "),n("li",[t._v("BP Queue：命中断点的请求会产生一个断点消息天到队列中，由用户进行处理。")])]),t._v(" "),n("h2",{attrs:{id:"请求列表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#请求列表"}},[t._v("#")]),t._v(" 请求列表")]),t._v(" "),n("p",[t._v("如图，在列表页你可以")]),t._v(" "),n("ol",[n("li",[t._v("控制是否需要记录代理服务器的请求")]),t._v(" "),n("li",[t._v("清理列表内容")]),t._v(" "),n("li",[t._v("设置断点")]),t._v(" "),n("li",[t._v("查看请求的Request、Response（只读）")]),t._v(" "),n("li",[t._v("给请求快速绑定Snippet，后续请求数据会被Snippet修改"),n("br"),t._v(" "),n("img",{attrs:{src:s(203),alt:"请求列表页"}})])]),t._v(" "),n("h2",{attrs:{id:"断点编辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#断点编辑"}},[t._v("#")]),t._v(" 断点编辑")]),t._v(" "),n("p",[t._v("给请求添加断点后，后续相同请求触发时会在BP Queue页面产生一条记录。"),n("br"),t._v("\n此时你可以编辑请求的内容，点击“完成”按钮后，请求才会进行下一步（发送到远程服务器或者被浏览器接收）。"),n("br"),t._v("\n此外你还可以选择跳过、中断当前请求；开关断点功能、跳过所有断点消息；勾选“自动开始下一个”表示处理完当前消息会马上激活下一条消息。"),n("br"),t._v(" "),n("img",{attrs:{src:s(204),alt:"断点编辑"}})]),t._v(" "),n("h2",{attrs:{id:"使用snippet"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用snippet"}},[t._v("#")]),t._v(" 使用Snippet")]),t._v(" "),n("p",[t._v("到这里，我们已经拥有了随意编辑Http请求的能力，但是断点编辑的效率很低。"),n("br"),t._v("\n开发调式阶段，同一个请求很可能会被发起多次，如果每次请求都需要断点编辑，这是无法忍受的。接口绑定Snippet后，后续该接口的数据会自动被Snippet修改。")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("如果不理解Snippet的含义可以参阅"),n("router-link",{attrs:{to:"/design.html#Snippet解释"}},[t._v("Snippet解释")]),t._v("，Snippet字段含义参阅"),n("router-link",{attrs:{to:"/config-desc.html#snippet"}},[t._v("配置说明")]),t._v("。"),n("br"),t._v(" "),n("em",[t._v("若你还没有安装SwitchyOmega插件、信任证书，请参阅"),n("router-link",{attrs:{to:"/start.html#代理配置"}},[t._v("代理配置")]),t._v("、"),n("router-link",{attrs:{to:"/trust-ca.html"}},[t._v("信任证书")])],1)],1)]),t._v(" "),n("h3",{attrs:{id:"接口绑定snippet"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#接口绑定snippet"}},[t._v("#")]),t._v(" 接口绑定Snippet")]),t._v(" "),n("ol",[n("li",[t._v("使用Chrome访问"),n("a",{attrs:{href:"https://www.mocky.io/v2/5185415ba171ea3a00704eed",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocky test api"),n("OutboundLink")],1),t._v("可以得到返回值：")])]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hello"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"world"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[n("p",[t._v("使用SwitchyOmega插件将当前域名的请求使用Erra代理。"),n("br"),t._v(" "),n("img",{attrs:{src:s(205),alt:"mocky代理设置",width:"200"}})])]),t._v(" "),n("li",[n("p",[t._v("刷新"),n("a",{attrs:{href:"https://www.mocky.io/v2/5185415ba171ea3a00704eed",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocky test api"),n("OutboundLink")],1),t._v("页面，在Erra Network页可以看到mocky的请求记录，并将其绑定到Simple-Demo。"),n("br"),t._v(" "),n("img",{attrs:{src:s(206),alt:"请求绑定Snippet"}})])]),t._v(" "),n("li",[n("p",[t._v("刷新"),n("a",{attrs:{href:"https://www.mocky.io/v2/5185415ba171ea3a00704eed",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocky test api"),n("OutboundLink")],1),t._v("页面，此时收到的返回值应为：")])])]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hello"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Erra!"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"编写snippet"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编写snippet"}},[t._v("#")]),t._v(" 编写Snippet")]),t._v(" "),n("p",[t._v("Erra初始时创建了几个Snippet Demo，你可以参考Demo学习简单用法。"),n("br"),t._v("\n可以尝试点击Snippet标签页下的“新增Snippet”按钮\n"),n("img",{attrs:{src:s(207),alt:"新增Snippet入口"}})]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("如果你要尝试学习本节内容，强烈建议参考"),n("router-link",{attrs:{to:"/start.html"}},[t._v("前文")]),t._v("启动Erra，从自带的Demo开始入手。")],1)]),t._v(" "),n("h3",{attrs:{id:"修改返回值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改返回值"}},[t._v("#")]),t._v(" 修改返回值")]),t._v(" "),n("p",[t._v("使用Snippet自动修改http内容，需要对http数据结构有些许了解。Erra将http结构简化为：")]),t._v(" "),n("div",{staticClass:"language-ts extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SimpleReq")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" HttpMethod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" StrObj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  body"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SimpleResp")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  statusCode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" StrObj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  body"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("以最简单的自动"),n("router-link",{attrs:{to:"/guide.html#修改返回值"}},[t._v("修改返回值")]),t._v("为例，将Http Response body内容"),n("code",[t._v("{ hello: 'world!' }")]),t._v("修改为"),n("code",[t._v("{ hello: Erra! }")]),t._v("。"),n("br"),t._v("\nHttp Response对应的数据结构为：")],1),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  statusCode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    hello"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world!'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("code",[t._v("Simple-Demo")]),t._v("对应的Snippet配置如下：")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 6353c69c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("e1e6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("4b34"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("a61a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("c44271fce483\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Simple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Demo\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hello")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Erra!\n")])])]),n("p",[t._v("我们可以看到，修改（或者说“覆盖”）Http请求中的某个值，只需要"),n("code",[t._v("content")]),t._v("内容的层级结构与之保持一致即可，不需要修改的字段（statusCode、headers）可以省略。")]),t._v(" "),n("h3",{attrs:{id:"集成mockjs，生成随机数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#集成mockjs，生成随机数"}},[t._v("#")]),t._v(" 集成mockjs，生成随机数")]),t._v(" "),n("p",[t._v("Snippet集成了Mockjs，用来快速生成mock数据。参考Erra自带的Snippet："),n("code",[t._v("Mockjs-Random")])]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Mockjs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Random\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# key的前缀`$mockjs `表示这个字段将被mockjs解析。")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据mockjs语法，hello的值将是一个随机字符串。")]),t._v("\n    $mockjs hello"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@str'")]),t._v("\n")])])]),n("p",[t._v("参考"),n("router-link",{attrs:{to:"/guide.html#修改返回值"}},[t._v("修改返回值")]),t._v("第三步，将mocky请求绑定到"),n("code",[t._v("Mockjs-Random")]),t._v("，再刷新"),n("a",{attrs:{href:"https://www.mocky.io/v2/5185415ba171ea3a00704eed",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocky test api"),n("OutboundLink")],1),t._v("页面，可以看到"),n("code",[t._v("hello")]),t._v("的值变成了随机字符串，可以再尝试刷新几次观察返回值。"),n("br"),t._v("\n这是一个返回示例：")],1),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hello"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IZUsd"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"代理转发请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代理转发请求"}},[t._v("#")]),t._v(" 代理转发请求")]),t._v(" "),n("p",[t._v("代理转发请求实际上就是修改Http请求中的"),n("code",[t._v("headers.host")]),t._v("和"),n("code",[t._v("url")]),t._v("两个字段，参考Erra自带的Snippet："),n("code",[t._v("Forward-Meituan")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Forward"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Meituan\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("when")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[t._v("!<tag:yaml.org,2002:js/regexp>")]),t._v(" /meituan.com/\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("headers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" www.mocky.io\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[t._v("!<tag:yaml.org,2002:js/function>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n    function anonymous(\n    ) "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    return '/v2/5185415ba171ea3a00704eed'\n\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("yaml的函数、正则支持参考"),n("a",{attrs:{href:"https://github.com/nodeca/js-yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("js-yaml"),n("OutboundLink")],1),t._v("，"),n("em",[t._v("上面代码中函数样式是js-yaml解析后的，看起来不是很舒服，是后续需要解决的问题")]),t._v("。"),n("br"),t._v("\n这里需要介绍一下字段"),n("code",[t._v("when")]),t._v("，表示请求的url被正则匹配成功，当前Snippet即生效，不需要像在Network页手动页面绑定请求。")])]),t._v(" "),n("ol",[n("li",[t._v("勾选"),n("code",[t._v("Forward-Meituan")]),t._v("前面的Checkbox"),n("br"),t._v(" "),n("img",{attrs:{src:s(208),alt:"勾选Snippet",width:"300"}})]),t._v(" "),n("li",[t._v("访问"),n("a",{attrs:{href:"https://sh.meituan.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("美团首页"),n("OutboundLink")],1)]),t._v(" "),n("li",[t._v("参考前文配置使用Erra代理，刷新页面")]),t._v(" "),n("li",[t._v("可以看到美团首页返回了一个json "),n("code",[t._v('{ "hello": "world" }')])])]),t._v(" "),n("h3",{attrs:{id:"注入eruda"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#注入eruda"}},[t._v("#")]),t._v(" 注入Eruda")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/liriliri/eruda",target:"_blank",rel:"noopener noreferrer"}},[t._v("Eruda"),n("OutboundLink")],1),t._v("是一款优秀的移动端Console工具，参考Erra自带的Snippet"),n("code",[t._v("Inject-Eruda")]),t._v("，原理就是向html中插入Eruda的启动代码。")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Inject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Eruda\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("headers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 避免被资源被CSP拦截")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content-security-policy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Snippet除了简单值之外还支持“表达式”，变量“V”是对原始值中当前字段的引用")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[t._v("!<!expression>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n    V.replace(/(<body.*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(")/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    '$1<script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("window.define=undefined</script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v('<script\n    src="//cdn.bootcss.com/eruda/1.5.2/eruda.min.js"'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("</script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("<script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("eruda.init();</script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("')\n")])])]),n("ol",[n("li",[t._v("去掉"),n("code",[t._v("Forward-Meituan")]),t._v("的勾选状态")]),t._v(" "),n("li",[t._v("访问"),n("a",{attrs:{href:"https://sh.meituan.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("美团首页"),n("OutboundLink")],1)]),t._v(" "),n("li",[t._v("Network页给请求"),n("code",[t._v("https://sh.meituan.com/")]),t._v("绑定"),n("code",[t._v("Inject-Eruda")])]),t._v(" "),n("li",[t._v("刷新美团首页"),n("br"),t._v(" "),n("img",{attrs:{src:s(209),alt:"美团-Eruda",width:"400"}})])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("Snippet除了简单值之外还支持“表达式”，变量“V”是对原始值中当前字段的引用。"),n("br"),t._v("\nInject-Eruda作用于html，所以“V”的值类似：<html><body>...</body></html>`")])]),t._v(" "),n("h3",{attrs:{id:"注入erra界面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#注入erra界面"}},[t._v("#")]),t._v(" 注入Erra界面")]),t._v(" "),n("p",[t._v("将Erra UI注入到调试的网页，所有Erra操作可以在当前页面完成，不需要切换浏览器Tab了，提高效率和体验。当有新的断点消息需要处理时，入口图标会闪烁。"),n("br"),t._v("\n注入方式与"),n("router-link",{attrs:{to:"/guide.html#注入Eruda"}},[t._v("注入Eruda")]),t._v("的步骤一致。"),n("br"),t._v(" "),n("img",{attrs:{src:s(210),alt:"美团-Erra",width:"400"}})],1),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("注意第六行的script src，如果被注入的页面在其他设备上打开，此时两台设备必须在同一个局域网内，然后将"),n("strong",[t._v("localhost改为当前设备的ipv4")]),t._v("（如192.168.1.4）")])]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")])]),n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Inject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Erra\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[t._v("!<!expression>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n    V.replace(/(<body.*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(")/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" '$1<script\n    src=\"https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//localhost"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("4455/erra/erra"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('portal.js"'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("</script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("')\n")])])]),n("h3",{attrs:{id:"snippet引用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#snippet引用"}},[t._v("#")]),t._v(" Snippet引用")]),t._v(" "),n("p",[t._v("这是Snippet高级功能，为解决mock数据复用的问题而设计。"),n("br"),t._v("\n参考Erra自带的Snippet"),n("code",[t._v("Include-Snippet")]),t._v("，"),n("code",[t._v("$snippet")]),t._v("前缀表示该字段的值交给另一个Snippet去修改。")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Include"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Snippet\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("code")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# “|”前面的名称是为了方便记忆，忽略名称不会导致错误")]),t._v("\n    $snippet include"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Simple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Demo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("6353c69c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("e1e6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("4b34"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("a61a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("c44271fce483\n")])])]),n("p",[t._v("Snippet名称后面的id不需要手动输入，输入名称第一个字母后编辑器会自动补全。"),n("br"),t._v(" "),n("img",{attrs:{src:s(211),alt:"Snippet自动补全",width:"400"}})]),t._v(" "),n("p",[t._v("将mocky请求绑定到"),n("code",[t._v("Include-Snippet")]),t._v("，刷新"),n("a",{attrs:{href:"https://www.mocky.io/v2/5185415ba171ea3a00704eed",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocky test api"),n("OutboundLink")],1),t._v("，将得到返回值：")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hello"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"world"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"include"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"body"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hello"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Erra!"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("在展开在Array、Object中引用的Snippet时，参考单测用例"),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/hughfenghen/erra/blob/master/src/server/manager/test/snippet-manager.test.ts#L107",target:"_blank",rel:"noopener noreferrer"}},[t._v("展开Object中的snippet引用"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/hughfenghen/erra/blob/master/src/server/manager/test/snippet-manager.test.ts#L130",target:"_blank",rel:"noopener noreferrer"}},[t._v("展开Array中的snippet引用"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);